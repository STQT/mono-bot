{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}–î–∞—à–±–æ—Ä–¥{% endblock %}

{% block content %}
<h1>üìä –î–∞—à–±–æ—Ä–¥</h1>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0;">
    <div style="background: #f0f0f0; padding: 20px; border-radius: 5px;">
        <h3>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ total_users }}</p>
        <p>–≠–ª–µ–∫—Ç—Ä–∏–∫–∏: {{ total_electricians }}</p>
        <p>–ü—Ä–æ–¥–∞–≤—Ü—ã: {{ total_sellers }}</p>
    </div>
    
    <div style="background: #e3f2fd; padding: 20px; border-radius: 5px;">
        <h3>üì± QR-–∫–æ–¥—ã</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ total_qrcodes }}</p>
        <p>–û—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ: {{ scanned_qrcodes }}</p>
        <p>–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: {{ unscanned_qrcodes }}</p>
    </div>
    
    <div style="background: #fff3e0; padding: 20px; border-radius: 5px;">
        <h3>üí∞ –ë–∞–ª–ª—ã</h3>
        <p>–≠–ª–µ–∫—Ç—Ä–∏–∫–∏: <strong>{{ total_points_electricians }}</strong></p>
        <p>–ü—Ä–æ–¥–∞–≤—Ü—ã: <strong>{{ total_points_sellers }}</strong></p>
    </div>
    
    <div style="background: #f3e5f5; padding: 20px; border-radius: 5px;">
        <h3>üéÅ –ü–æ–¥–∞—Ä–∫–∏</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ total_gifts }}</p>
        <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö: {{ active_gifts }}</p>
        <p>–û–∂–∏–¥–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏: {{ pending_redemptions }}</p>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px;">
    <div>
        <h2>üèÜ –¢–û–ü-10 –õ–∏–¥–µ—Ä–æ–≤ (–≠–ª–µ–∫—Ç—Ä–∏–∫–∏)</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #417690; color: white;">
                    <th style="padding: 10px; text-align: left;">–ú–µ—Å—Ç–æ</th>
                    <th style="padding: 10px; text-align: left;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                    <th style="padding: 10px; text-align: right;">–ë–∞–ª–ª—ã</th>
                </tr>
            </thead>
            <tbody>
                {% for leader in top_electricians %}
                <tr style="border-bottom: 1px solid #ddd;">
                    <td style="padding: 10px;">
                        {% if forloop.counter == 1 %}ü•á
                        {% elif forloop.counter == 2 %}ü•à
                        {% elif forloop.counter == 3 %}ü•â
                        {% else %}{{ forloop.counter }}{% endif %}
                    </td>
                    <td style="padding: 10px;">{{ leader.first_name|default:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å" }} (@{{ leader.username|default:"N/A" }})</td>
                    <td style="padding: 10px; text-align: right; font-weight: bold;">{{ leader.points }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" style="padding: 10px; text-align: center;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div>
        <h2>üèÜ –¢–û–ü-10 –õ–∏–¥–µ—Ä–æ–≤ (–ü—Ä–æ–¥–∞–≤—Ü—ã)</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #417690; color: white;">
                    <th style="padding: 10px; text-align: left;">–ú–µ—Å—Ç–æ</th>
                    <th style="padding: 10px; text-align: left;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                    <th style="padding: 10px; text-align: right;">–ë–∞–ª–ª—ã</th>
                </tr>
            </thead>
            <tbody>
                {% for leader in top_sellers %}
                <tr style="border-bottom: 1px solid #ddd;">
                    <td style="padding: 10px;">
                        {% if forloop.counter == 1 %}ü•á
                        {% elif forloop.counter == 2 %}ü•à
                        {% elif forloop.counter == 3 %}ü•â
                        {% else %}{{ forloop.counter }}{% endif %}
                    </td>
                    <td style="padding: 10px;">{{ leader.first_name|default:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å" }} (@{{ leader.username|default:"N/A" }})</td>
                    <td style="padding: 10px; text-align: right; font-weight: bold;">{{ leader.points }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" style="padding: 10px; text-align: center;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

